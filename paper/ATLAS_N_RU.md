# ATLAS N: Формальные основания экспериментальной картографии сложных параметризованных систем

> ⚠️ Важно  
> Этот текст — исследовательская записка (idea vault), а не продукт, не документация и не туториал.  
> Ничто в этом репозитории не является догмой: всё здесь временно, пересматриваемо и имеет право быть неверным.

## Аннотация
ATLAS N — методология и система для систематического исследования пространств конфигураций сложных параметризованных систем через теорию информации, структурный анализ и минимальную формальную верификацию. В отличие от утилитарных подходов, ориентированных на поиск отдельных «рабочих» конфигураций, ATLAS N ставит задачу построения воспроизводимой и предсказуемой карты поведения системы в условиях неполной наблюдаемости и динамического контекста.

На примере домена VPN (как модельной сложной системы) представлены:
1) модель знания для частично наблюдаемых систем;
2) операционные инварианты в виде теорем и автоматически проверяемых правил;
3) структурная модель пространства конфигураций (кластеры, границы, хаотические области);
4) постановка задачи оптимального информационного исследования;
5) минимальная формальная спецификация базовых safety-свойств;
6) канон правил MVRS как исполнимый мост между теорией и практикой.

Ключевая идея — исполняемый канон, превращающий требования строгой методологии в автоматические проверки, которые нельзя «обойти словами».

---

## 1. Проблема: исследование сложных параметризованных систем

### 1.1. Почему VPN — хорошая модель
VPN-системы удобны как модельная сложная система:
- высокая размерность: протоколы, шифры, транспорт, параметры, эндпоинты, маршрутизация;
- динамичность: меняются сетевые условия, фильтрация, DPI и инфраструктура;
- контекстная зависимость: время, география, сетевой стек, путь в сети, состояние среды;
- частичная наблюдаемость: видим вход (конфигурацию) и выход (исход), но не «внутренности».

### 1.2. Что не так с традиционным подходом
Эвристический поиск и «топы» плохо подходят для накопления знания:
1) знание непереносимо — каждый начинает с нуля;
2) воспроизводимость слабая — успех вчера не гарантирует успех сегодня;
3) негативные результаты исчезают;
4) нет ответа на «почему», значит нет устойчивых выводов.

### 1.3. Картография вместо поиска
ATLAS N строит карту наблюдений, где каждая точка — это тройка:
(конфигурация, контекст, исход)

Карта позволяет:
- находить структуру (кластеры, границы, аномалии);
- прогнозировать поведение в неисследованных областях;
- выделять устойчивые закономерности;
- отслеживать эволюцию «ландшафта доступности».

Гипотеза: даже в нестабильных доменах существуют устойчивые структуры, которые проявляются только при систематическом, воспроизводимом и контекстно-полном наблюдении.

Операционная гарантия: гипотеза материализована в каноне MVRS; нарушение канона лишает систему статуса «ATLAS».

---

## 2. Формальная модель знания

### 2.1. Определения
Пусть:
- C — пространство конфигураций (конечное или счётное),
- K — пространство контекстов выполнения,
- O = {SUCCESS, FAILURE, ERROR} — наблюдаемые исходы,
- f: C × K → O — истинная (неизвестная) функция поведения.

Данные наблюдений:
D_t = {(c₁,k₁,o₁), …, (cₙ,kₙ,oₙ)},
где каждое наблюдение — ExperimentRecord с полным ContextSnapshot.

### 2.2. Ограниченная энтропия и полнота
Пусть S_t ⊆ C × K — покрытое множество пар (c,k), для которых есть хотя бы одно наблюдение.

Оценка вероятностей с псевдосчётами (Dirichlet α=1):
P̂(o|c,k) = (N(c,k,o)+1) / (N(c,k)+|O|)

Ограниченная энтропия:
H_t = - Σ_{(c,k)∈S_t} Σ_{o∈O} P̂(o|c,k) log₂ P̂(o|c,k)

Информационная полнота: H_t = 0 тогда и только тогда, когда для каждой пары (c,k) распределение вырождено (доминирует один исход).

Прогресс исследования: в режиме уточнения ожидается, что H_t в среднем уменьшается (не «процент успеха» важен, а снижение неопределённости).

### 2.3. Условная ценность наблюдений
Для вероятности успеха p = P(SUCCESS|c,k):
I(success) = -log₂ p
I(failure) = -log₂ (1-p)

Следствия:
- при p < 0.5 неудача информативнее успеха;
- максимальная ценность наблюдений возникает в зоне p≈0.5.

Операционный смысл: оптимизация «ради успеха» ухудшает картографирование, потому что вытесняет исследование границ и зон неопределённости.

---

## 3. Инварианты как теоремы и правила

### 3.1. Монотонность знания (I-02.01)
Требование: D_{t+1} ⊇ D_t.

Система, допускающая удаление наблюдений, может разрушить сходимость метрик знания (возникают колебания и несопоставимость результатов).

Правило I-02.01 (нестираемость): ExperimentRecord иммутабелен; исправления только через CorrectionRecord; архитектура append-only. Severity: CATASTROPHIC.

### 3.2. Разделение фаз (I-06.01)
Генерация наблюдений (Phase I) не должна зависеть от интерпретации (Phase II).

Правило I-06.01: Phase I и Phase II — разные процессы и разные БД; Phase I не использует результаты Phase II. Severity: CATASTROPHIC.

### 3.3. Полный контекст (I-01.01)
Без полного контекста возникают логические «противоречия» вида: одна и та же конфигурация одновременно успешна и неуспешна в «одинаковых» условиях.

Правило I-01.01: каждый ExperimentRecord обязан содержать полный ContextSnapshot, валидируемый схемой. Severity: CATASTROPHIC.

---

## 4. Структура пространства конфигураций

### 4.1. Метрика
Вводится метрика на C×K:
d((c₁,k₁),(c₂,k₂)) = α·d_C(c₁,c₂) + β·d_K(k₁,k₂),
где d_C и d_K задаются конфигурацией проекта.

### 4.2. Кластеры, границы, хаотические области
- Устойчивый кластер: связная область, где доминирующий исход почти одинаков.
- Граница: в любой малой окрестности встречаются разные исходы; «тонкость» означает, что у многих точек есть близкие соседи с другим исходом.
- Хаотическая область: малые изменения дают непредсказуемые изменения исхода.

Эмпирически для VPN ожидаются: крупные кластеры современных протоколов, фрагментация устаревающих режимов, границы по транспорту/шифру/MTU и зоны нестабильности при активном противодействии.

---

## 5. Оптимальное информационное исследование

### 5.1. Два вида прогресса
1) уточнение на покрытом множестве S_t (снижение энтропии);
2) расширение покрытия (увеличение |S_t|).

### 5.2. Информационный выигрыш
Для уточнения:
IG_refine(c,k) = H(D_t) - E[H(D_t ∪ {(c,k,o)})]

На практике планирование использует приближённые оценки и дискретизацию пространства.

### 5.3. UCB-подобная эвристика (без ложных гарантий)
В дискретизованном подмножестве:
(c_next,k_next) = argmax [ IG_estimate(c,k) + γ·sqrt(log t / N(c,k)) ]

Это эвристика баланса exploration/exploitation; она не претендует на строгие гарантии в больших/непрерывных пространствах.

---

## 6. Минимальная формальная верификация
Есть два слоя проверяемости:
1) формальные safety-свойства данных (типизация, append-only);
2) операционные запреты и правила (разделение фаз, полнота контекста, воспроизводимость) — через тесты канона.

Минимальный эскиз (пример) для append-only идеи:
- состояние содержит множество наблюдений;
- Next только добавляет элементы;
- инвариант: наблюдения не уменьшаются.

Полная доменная спецификация может расширяться, но канон остаётся первичным механизмом контроля корректности процесса.

---

## 7. Практическая реализация в домене VPN (как пример)
Типовые декомпозиции:
C = Protocols × Ciphers × Parameters × Endpoints × Transport
K = NetworkProfile × Time × Geolocation × ClientStack × MethodologyRef

Phase I (измерение) фиксирует контекст, исполняет эксперимент в изоляции, пишет запись в append-only хранилище и генерирует артефакты воспроизводимости. Phase II анализирует данные отдельно, не влияя на Phase I.

---

## 8. Канон MVRS как исполнимый контракт
SSOT: `rules/canonical/mvrs.yaml`
MVRS = {I-01.01, I-02.01, I-03.01, I-06.01, I-07.01, P-02.01, X-01.01}

Нарушение любого правила означает, что система перестала быть «ATLAS».

Каждое правило имеет машинно-читаемую формулировку и проверку (тест/валидатор), а CI блокирует изменения, нарушающие канон.

---

## 9. Обсуждение и ограничения
Ограничения:
1) локальная гладкость может ломаться пороговыми эффектами;
2) пространство C×K огромно — нужен умный выбор экспериментов;
3) контекст наблюдаем не полностью — важно честно фиксировать то, что реально измеримо.

---

## 10. Заключение
ATLAS N — методология экспериментальной картографии сложных параметризованных систем. Основной вклад:
- переход от «поиска решений» к накоплению карты знания;
- формализация инвариантов и их воплощение в правила MVRS;
- операционная строгость через автоматические проверки;
- переносимость подхода на другие домены (БД, компиляторы, облака, безопасность).

---

## 11. Этика и ответственность
ATLAS N — исследовательский проект, ориентированный на изучение поведения систем.
Проект:
- не предоставляет инструкций по обходу ограничений и не поощряет незаконную деятельность;
- публикует только агрегированные и обезличенные результаты;
- не хранит конфиденциальные данные (ключи, пароли, приватные эндпоинты);
- использует публичные или тестовые конфигурации;
- минимизирует сбор идентифицирующих данных.

---

## Литература
1. Shannon, C. E. (1948). A Mathematical Theory of Communication.
2. Pearl, J. (2009). Causality: Models, Reasoning, and Inference.
3. Lamport, L. (2002). Specifying Systems: The TLA+ Language and Tools.
4. Sutton, R. S., & Barto, A. G. (2018). Reinforcement Learning: An Introduction.
5. Устав и Конституция проекта «ATLAS». (2024). SSOT: docs/atlas_n.
