# ATLAS N  
Формальные основания экспериментальной картографии сложных параметризованных систем

⚠️ Статус  
Данный текст является исследовательской запиской (idea vault).  
Он не является продуктовой документацией, стандартом или руководством к действию.  
Все утверждения подлежат пересмотру, уточнению и опровержению по мере накопления эмпирических данных.

### Аннотация  
ATLAS N — методология и исполняемая система для систематического исследования пространств конфигураций сложных параметризованных систем в условиях частичной наблюдаемости и динамического контекста. В отличие от утилитарных подходов, ориентированных на поиск отдельных «рабочих» конфигураций, ATLAS N формулирует задачу построения воспроизводимой карты знания о поведении системы как функции конфигурации и контекста.

В качестве модельного домена используется VPN-система, обладающая высокой размерностью, нестабильностью и контекстной чувствительностью. В рамках ATLAS N вводятся:

1. формальная модель знания для частично наблюдаемых систем;  
2. операционные инварианты, оформленные как теоремы и исполнимые правила;  
3. структурная модель пространства конфигураций (кластеры, границы, хаотические области);  
4. постановка задачи оптимального информационного исследования;  
5. минимальная формальная спецификация базовых safety-свойств процесса;  
6. канон MVRS как исполняемый контракт между теорией и реализацией.

Ключевая идея ATLAS N — исполняемый канон, превращающий методологические требования в автоматические проверки, которые невозможно обойти декларациями или интерпретациями.

### 1. Проблема: исследование сложных параметризованных систем  
#### 1.1. Почему VPN — подходящая модельная система  
VPN-системы являются удобным примером сложных параметризованных систем по следующим причинам:

- высокая размерность пространства конфигураций (протоколы, криптография, транспорт, параметры, эндпоинты, маршрутизация);  
- динамичность среды (изменение сетевых условий, фильтрации, DPI, инфраструктуры);  
- сильная контекстная зависимость (время, география, путь в сети, клиентский стек, состояние ОС);  
- частичная наблюдаемость: наблюдаемы только вход (конфигурация, контекст) и выход (исход), но не внутренние механизмы поведения системы.

Эти свойства делают VPN-домен показательным примером класса систем, где наивные методы поиска решений систематически терпят неудачу.

#### 1.2. Ограничения традиционного подхода  
Эвристический поиск «рабочих конфигураций» и агрегированные рейтинги обладают рядом фундаментальных недостатков:

1. знание непереносимо — каждый исследователь начинает заново;  
2. воспроизводимость низкая — успех в одном контексте не гарантирует успеха в другом;  
3. отрицательные результаты теряются и не накапливаются;  
4. отсутствует объяснительная сила: нет ответа на вопрос «почему».

В результате система остаётся эмпирически непрозрачной, а накопленный опыт не конвертируется в устойчивое знание.

#### 1.3. Картография вместо поиска  
ATLAS N заменяет задачу поиска решений задачей картографирования поведения системы. Базовая единица наблюдения — тройка:

$$ (c, k, o), \quad o \in O = \{\text{SUCCESS}, \text{FAILURE}, \text{ERROR}\}, $$

где \( c \) — конфигурация, \( k \) — контекст выполнения, \( o \) — наблюдаемый исход.

Совокупность таких наблюдений формирует карту, позволяющую:

- выявлять структурные элементы (кластеры, границы, аномалии);  
- прогнозировать поведение в неисследованных областях;  
- различать устойчивые закономерности и контекстные эффекты;  
- отслеживать эволюцию ландшафта доступности во времени.

Гипотеза ATLAS N состоит в том, что даже в нестабильных доменах существуют устойчивые структуры, проявляющиеся только при систематическом, воспроизводимом и контекстно-полном наблюдении.  
Операциональная гарантия: данная гипотеза материализована в каноне MVRS; нарушение канона лишает систему статуса «ATLAS».

### 2. Формальная модель знания  
#### 2.1. Базовые определения  
Пусть:

- \( C \) — пространство конфигураций (конечное или счётное);  
- \( K \) — пространство контекстов выполнения;  
- \( O = \{\text{SUCCESS}, \text{FAILURE}, \text{ERROR}\} \) — множество наблюдаемых исходов;  
- \( f : C \times K \to O \) — истинная, но неизвестная функция поведения системы.

Наблюдаемые данные к моменту времени \( t \):

$$ D_t = \{(c_1, k_1, o_1), \ldots, (c_n, k_n, o_n)\}, $$

где каждое наблюдение представлено как неизменяемый ExperimentRecord, содержащий полный ContextSnapshot.

Обозначим покрытое множество:

$$ S_t \subseteq C \times K, $$

состоящее из всех пар \( (c, k) \), для которых существует хотя бы одно наблюдение.

#### 2.2. Неопределённость на покрытии и покрытие пространства  
Для каждой пары \( (c, k) \) вероятности исходов оцениваются с использованием псевдосчётов Дирихле (\( \alpha = 1 \)):

$$ \hat{P}(o \mid c,k) = \frac{N(c,k,o) + 1}{N(c,k) + |O|}. $$

Суммарная остаточная неопределённость на покрытии:

$$ H_{\text{refine}}(t) = -\sum_{(c,k) \in S_t} \sum_{o \in O} \hat{P}(o \mid c,k) \log_2 \hat{P}(o \mid c,k). $$

Важно: как суммарная величина, \(H_{\text{refine}}(t)\) может расти при расширении покрытия \(S_t\), что само по себе не является деградацией качества знания; это отражает увеличение объёма описываемой области. Для сравнения состояний при разном покрытии используется нормированная форма \( H_{\text{refine}}(t) / |S_t| \), интерпретируемая как средняя неопределённость на точку покрытия.

Мера покрытия для конечного пространства:

$$ \text{Coverage}(t) = \frac{|S_t|}{|C \times K|}. $$

Для бесконечного или практически недостижимого пространства — приближение через версионированную дискретизацию \( \Pi \) (MethodologyRef):

$$ \text{Coverage}_{\Pi}(t) = \frac{|\Pi(S_t)|}{|\Pi(C \times K)|}. $$

Таким образом:

- \( H_{\text{refine}}(t) = 0 \) соответствует полной определённости на покрытии;  
- высокая Coverage при высоком \( H_{\text{refine}} \) означает поверхностное исследование;  
- снижение \( H_{\text{refine}} \) без роста Coverage означает локальное уточнение.

#### 2.3. Информационная ценность наблюдений  
Для \( p = P(\text{SUCCESS} \mid c,k) \) вводится локальная мера неожиданности (surprisal):

$$ I(\text{success}) = -\log_2 p, \quad I(\text{failure}) = -\log_2 (1-p). $$

Следствия:

- при \( p < 0.5 \) неудача информативнее успеха;  
- максимальная информативность достигается в области \( p \approx 0.5 \).

Эта мера используется как локальная эвристика. Ожидаемый информационный выигрыш задаётся через ожидаемое изменение \( H_{\text{refine}} \) (см. раздел 5).

### 3. Инварианты как теоремы и исполнимые правила  
#### 3.1. Монотонность знания (I-02.01)  
Требование:

$$ D_{t+1} \supseteq D_t. $$

Удаление или модификация наблюдений разрушает сходимость метрик знания и делает сравнение состояний системы некорректным.

Правило I-02.01 (нестираемость):  
ExperimentRecord неизменяем. Исправления допускаются только через CorrectionRecord, ссылающийся на оригинал. Архитектура — строго append-only.  
Severity: CATASTROPHIC.  
Наблюдаемые индикаторы: отсутствие операций UPDATE/DELETE; монотонный рост журнала; корректные ссылки исправлений.  
Формальная спецификация и машинные проверки правил — см. канон MVRS (раздел 8).

#### 3.2. Разделение фаз (I-06.01)  
Генерация наблюдений (Phase I) не должна зависеть от интерпретации и анализа данных (Phase II).

Правило I-06.01:  
Phase I и Phase II реализованы как логически и физически раздельные процессы и хранилища. Phase I не использует результаты Phase II.  
Severity: CATASTROPHIC.  
Индикаторы: раздельные БД/артефакты; отсутствие обратных зависимостей; воспроизводимость Phase I при отключённой Phase II.

#### 3.3. Полнота контекста (I-01.01)  
Без полного контекста наблюдения могут создавать кажущееся противоречие: одинаковая конфигурация ведёт себя «по-разному» в якобы одинаковых условиях.

Правило I-01.01:  
Каждый ExperimentRecord обязан содержать полный ContextSnapshot, валидируемый версионированной схемой.  
Severity: CATASTROPHIC.

### 4. Структура пространства конфигураций  
#### 4.1. Метрика  
На пространстве \( C \times K \) вводится метрика:

$$ d((c_1, k_1), (c_2, k_2)) = \alpha \cdot d_C(c_1, c_2) + \beta \cdot d_K(k_1, k_2), $$

где \( d_C \) и \( d_K \) задаются проектом (например, Хэммингово расстояние по параметрам).

#### 4.2. Операциональные структуры  
Фиксируем радиус \( r \) и строим граф соседства \( G_r \) на покрытии \( S_t \): вершины — пары \( (c,k) \in S_t \), ребро проводится, если \( d \le r \).

- Устойчивый кластер: связная компонента в \( G_r \), где доля доминирующего исхода ≥ \( \tau \).  
- Граница: для каждой точки в компоненте в её \( r \)-окрестности встречаются как минимум два исхода с долей ≥ \( \varepsilon \).  
- Хаотическая область: высокая чувствительность — близкие точки по \( d \) демонстрируют существенно различающиеся распределения исходов.

Параметры \( r, \tau, \varepsilon \) являются ключевыми гиперпараметрами методологии: их выбор фиксируется в MethodologyRef и определяет гранулярность карты.

### 5. Оптимальное информационное исследование  
#### 5.1. Два типа прогресса  
1. уточнение на покрытии (снижение \( H_{\text{refine}}(t) \));  
2. расширение покрытия (рост Coverage по выбранной дискретизации \( \Pi \)).

#### 5.2. Ожидаемый информационный выигрыш  
Для уточнения:

$$ IG_{\text{refine}}(c,k) = H_{\text{refine}}(t) - \mathbb{E}\left[ H_{\text{refine}}(t+1) \mid (c,k) \right]. $$

#### 5.3. Планирование экспериментов  
В дискретизованном пространстве используется эвристика:

$$ (c_{\text{next}}, k_{\text{next}}) = \arg\max \left[ IG_{\text{estimate}}(c,k) + \gamma \sqrt{\frac{\log t}{N(c,k)}} \right], $$

где \( \gamma \) — коэффициент баланса исследования.  
Эвристика не претендует на строгие гарантии и используется как практический инструмент.

Выбор дискретизации \( \Pi \) и принцип выбора новых точек \((c,k)\) для расширения покрытия (вне \(S_t\)) является частью методологического профиля (MethodologyRef) и фиксируется как элемент воспроизводимости исследования.

### 6. Минимальная формальная верификация  
Верификация ограничивается процессом накопления знания, а не доменной логикой VPN.  
Моделируется:

- состояние как множество ExperimentRecord;  
- единственный переход — добавление записи;  
- невозможность удаления или изменения наблюдений.

Инвариант монотонности (append-only):

$$ D_{t+1} \supseteq D_t. $$

Следствие:

$$ |D_{t+1}| \geq |D_t|. $$

Не моделируются: сетевые эффекты, DPI, причинные механизмы. Ограничения фиксируются явно.

### 7. Практическая декомпозиция (VPN как пример)  
Типовая факторизация:

$$ C = \text{Protocols} \times \text{Ciphers} \times \text{Parameters} \times \text{Endpoints} \times \text{Transport}, $$  
$$ K = \text{NetworkProfile} \times \text{Time} \times \text{Geolocation} \times \text{ClientStack} \times \text{MethodologyRef}. $$

Phase I фиксирует контекст, выполняет эксперимент и записывает артефакты воспроизводимости.  
Phase II анализирует данные независимо.

### 8. Канон MVRS как исполнимый контракт  
SSOT: rules/canonical/mvrs.yaml.  

MVRS — набор правил, каждое из которых содержит:

- идентификатор;  
- intent;  
- формальную формулировку;  
- машинную проверку;  
- severity;  
- типовой сценарий нарушения.

Нарушение любого правила означает, что система перестаёт соответствовать ATLAS N.

### 9. Ограничения  
1. локальная гладкость может разрушаться пороговыми эффектами;  
2. пространство \( C \times K \) практически бесконечно;  
3. контекст наблюдаем не полностью;  
4. качество карты ограничено качеством фиксации контекста и выбранной дискретизацией.

### 10. Заключение  
ATLAS N формализует переход от поиска решений к накоплению карты знания. Его вклад заключается в:

- явной модели знания для частично наблюдаемых систем;  
- формализации инвариантов процесса исследования;  
- исполняемом каноне MVRS;  
- переносимости подхода на другие домены (БД, компиляторы, облачные конфигурации, безопасность).

### 11. Этика и ответственность  
Проект ATLAS N:

- не публикует инструкции по обходу ограничений;  
- использует только агрегированные и обезличенные данные;  
- исключает публикацию информации, позволяющей восстановить конкретные эндпоинты, ключи или уникальные отпечатки;  
- ориентирован на исследование, а не эксплуатацию систем.

### Литература  
1. Shannon, C. E. A Mathematical Theory of Communication.  
2. Pearl, J. Causality: Models, Reasoning, and Inference.  
3. Lamport, L. Specifying Systems: The TLA+ Language and Tools.  
4. Sutton, R. S., & Barto, A. G. Reinforcement Learning: An Introduction.  
5. Устав и Конституция проекта «ATLAS». SSOT: docs/atlas_n.